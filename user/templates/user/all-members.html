{% extends 'user/layouts/master.html' %}
{% block content %}
{% load static %}



<!-- side bar -->
<div id="sidebar" class="active">
    <div class="sidebar-wrapper active ps ps--active-y">
        <div class="sidebar-header">
            <div class="justify-content-between">
                <div class="logo mb-3 text-center">
                    {% comment %} <img src="{{user.member.img.url }}" class="myimg" /> {% endcomment %}
                    <img src="{% static 'images/logo/logooo.png' %}" style="width:auto; height:200px"alt="Logo">
                </div>
                <div class="toggler">
                    <a href="#" class="sidebar-hide d-xl-none d-block"><i class="bi bi-x bi-middle"></i></a>
                </div>
            </div>
        </div>
        <div class="sidebar-menu">
            <ul class="menu">
                <li class="sidebar-title">Menu</li>

                <li class="sidebar-item">
                    <a href="{% url 'dashboard' %}" class="sidebar-link">
                        <i class="bi bi-grid-fill"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
{% if user.is_staff %}
                <li class="sidebar-item has-sub active">
                    <a href="#" class="sidebar-link">
                        <i class="bi bi-people-fill"></i>
                        <span>Members</span>
                    </a>
                    <ul class="submenu" style="display: none;">
                        <li class="submenu-item">
                            <a href="{% url 'add-member' %}">Add Member</a>
                        </li>
                        
                        <li class="submenu-item active">
                            <a href="{% url 'all-members' %}">All Members</a>
                        </li>
                        <li class="submenu-item">
                            <a href="{% url 'member-requests' %}">Member Requests</a>
                        </li>
                        <li class="submenu-item">
                            <a href="{% url 'manage-members' %}">Manage Members</a>
                        </li>
                    </ul>
                </li>
{% endif %}
{% if user.is_superuser %}
                <li class="sidebar-item has-sub">
                    <a href="#" class="sidebar-link">
                        <i class="bi bi-people-fill"></i>
                        <span>Users</span>
                    </a>
                    <ul class="submenu" style="display: none;">
 
                        <li class="submenu-item">
                            <a href="{% url 'active-users' %}">Active Users</a>
                        </li>
                        <li class="submenu-item">
                            <a href="{% url 'blocked-users' %}">Blocked Users</a>
                        </li>
                    <li class="submenu-item">
                        <a href="{% url 'manage-users' %}">Manage Users</a>
                    </li>
                    </ul>
                </li>
{% endif %}
                <li class="sidebar-item  has-sub">
                    <a href="#" class="sidebar-link">
                        <i class="bi bi-pie-chart-fill"></i>
                        <span>Reports</span>
                    </a>
                    <ul class="submenu ">
                        <li class="submenu-item ">
                            <a href="{% url 'sex-report' %}">Gender Reports</a>
                        </li>
                        <li class="submenu-item ">
                            <a href="{% url 'brgy-report' %}">Barangay Reports</a>
                        </li>
                        <li class="submenu-item">
                            <a href="{% url 'status-report' %}">Status Report</a>
                        </li>
                    </ul>
                </li>
            
                <hr>
                {% if user.is_authenticated %}
                <li class="sidebar-item">
                     <a href="{% url 'logout' %}" class="sidebar-link" onclick="return confirm('Logout?')">
                        <i class="bi bi-window close-fill"></i>
                        <span class="text-danger">Logout</span>
                    </a>
                </li>
                {% endif %}

                
            </ul>
        </div>
</div>
</div>
<div class="page-heading">
    <div class="page-title">
        <div class="row">
            <div class="col-12 col-md-6 order-md-1 order-last">
                <h3>All Members</h3>
            </div>
            <div class="col-12 col-md-6 order-md-2 order-first">
                <nav aria-label="breadcrumb" class="breadcrumb-header float-start float-lg-end">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Dashboard</a></li>
                        <li class="breadcrumb-item active" aria-current="page">All Members</li>
                    </ol>
                    <div class="btn-group mt-1" role="group" aria-label="Basic example">
                        <button onclick="printDiv('printableArea')" class="btn btn-secondary" data-bs-toggle="tooltip" data-bs-placement="top"
                        title="Print"><i class="bi bi-printer"></i></button>
                        <button type="button" class="btn btn-light"data-bs-toggle="tooltip" data-bs-placement="top"
                        title="Download"><i class="bi bi-download"></i></button>
                        <button type="button" class="btn btn-dark"  data-bs-toggle="tooltip" data-bs-placement="top"title="Export as CSV"><a id="download-button">Export as CSV</a></button>
                    </div>
                </nav>
               
            </div>
        </div>
</div>
</div>
    <section class="section">
        <div class="card">

            <div class="card-body" id="printableArea">
                <table class="table table-hover" id="table1">
                    <thead>
                        <tr style="background-color: #435EBE; color:white;">
                        <th class="col-2" style="color:white;"><center>FSCAP No.</center></th>
                        <th class="col-2">Name</th>
                        <th class="col-2">Contact Info</th>
                        <th class="col-2">Barangay</th> 
                        <th class="col-1">Status</th>
                        <th class="col-3">Date Joined</th>                           					

                        </tr>
                    </thead>
                    <tbody>
                        {% for members in member %}
                    <tr>
                        <td><center>118-0{{members.id }}</center></td>
                        <td>{{ members.last_name| title }}, {{ members.first_name |title }} </td>
                        <td>+63{{ members.contact_number }} </td>                        
                        <td>{{ members.get_barangay_display }} </td>
                        <td>{{ members.get_userstatus_display }} </td>
                        <td>{{ members.user.date_joined }} </td>
                    </tr>
                    {% endfor %}  
                        
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    </section>






{% endblock %}
{% block styles %}
<link rel="stylesheet" href="{% static 'vendors/simple-datatables/style.css' %}">



    <!-- datatable core -->
    <link href="plugins/css/jquery.dataTables.min.css" rel="stylesheet">
    <!-- Custom Css -->
	<link href="bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="bootstrap/bootstrap.css"  rel="stylesheet">
    <link href="bootstrap/_bootswatch.scss"  rel="stylesheet">
    <link href="bootstrap/_variables.scss"  rel="stylesheet">
     <!-- dataTables Btn -->
     <link href="{% static 'datatable/buttons.dataTables.min.css' %}"  rel="stylesheet">
     <link href="{% static 'datatable/select.dataTables.min.css' %}"  rel="stylesheet">
     <link href="{% static 'datatable/jquery.dataTables.min.css' %}"  rel="stylesheet">
{% endblock %}
{% block js %}
<script src="{% static 'vendors/simple-datatables/simple-datatables.js' %}"></script>
<script>
    // Simple Datatable
    let table1 = document.querySelector('#table1');
    let dataTable = new simpleDatatables.DataTable(table1);

function printDiv(divName){
    var printContents = document.getElementById(divName).innerHTML;
    var originalContents = document.body.innerHTML;

    document.body.innerHTML = printContents;

    window.print();

    document.body.innerHTML = originalContents;

    }

function htmlToCSV(html, filename) {
    var data = [];
    var rows = document.querySelectorAll("table tr");

    for (var i = 0; i < rows.length; i++) {
        var row = [],
            cols = rows[i].querySelectorAll("td, th");

        for (var j = 0; j < cols.length; j++) {
            row.push(cols[j].innerText);
        }

        data.push(row.join(","));
    }

    downloadCSVFile(data.join("\n"), filename);
}

function downloadCSVFile(csv, filename) {
	var csv_file, download_link;

	csv_file = new Blob([csv], {type: "text/csv"});

	download_link = document.createElement("a");

	download_link.download = filename;

	download_link.href = window.URL.createObjectURL(csv_file);

	download_link.style.display = "none";

	document.body.appendChild(download_link);

	download_link.click();
}

document.getElementById("download-button").addEventListener("click", function () {
	var html = document.querySelector("table").outerHTML;
	htmlToCSV(html, "seniorcitizen.csv");
});

function demoFromHTML() {
    var pdf = new jsPDF('p', 'pt', 'letter');
    source = $('#table1')[0];
    specialElementHandlers = {
        // element with id of "bypass" - jQuery style selector
        '#bypassme': function (element, renderer) {
            // true = "handled elsewhere, bypass text extraction"
            return true
        }
    };
    margins = {
        top: 80,
  
        bottom: 60,
        left: 40,
        width: 522
    };
    // all coords and widths are in jsPDF instance's declared units
    // 'inches' in this case
    pdf.fromHTML(
    source, // HTML string or DOM elem ref.
    margins.left, // x coord
    margins.top, { // y coord
        'width': margins.width, // max width of content on PDF
        'elementHandlers': specialElementHandlers
    },

    function (dispose) {
        // dispose: object with X, Y of the last line add to the PDF 
        //          this allow the insertion of new lines after html
        pdf.save('Test.pdf');
    }, margins);
}

function myFunction() {
var x = document.getElementById("myInput");
if (x.type === "password") {
x.type = "text";
} else {
x.type = "password";
}
}


</script>
{% endblock %}